import React, { useEffect } from 'react';
import styled from 'styled-components';

import { useTranslator, LocalizationKey } from '../localization';
import { PAGES, PAGE_CHAT, PAGE_SETTINGS } from '../modules/pages';
import { ReduxProps } from '../containers/Navigation';

const StyledNav = styled.nav`
    font-size: ${({ theme }) => theme.navigationFontSize};
    font-weight: ${({ theme }) => theme.navigationFontWeight};
    position: fixed;
    right: ${({ theme }) => theme.spacing.double};
    top: ${({ theme }) => theme.spacing.double};
    z-index: 2;
    color: ${({ theme }) => theme.navigationActiveColor};
    @media (max-width: ${({ theme }) => theme.mobileBreakpoint}) {
        right: ${({ theme }) => theme.spacing.regular};
        top: ${({ theme }) => theme.spacing.regular};
    }    
`;

const StyledNavItem = styled.li<{active: boolean, numNotification: number | boolean}>`
    display: inline-block;
    background: ${({ theme }) => theme.navigationItemBackground};
    border-radius: 40px; // Deliberately not using theme - we want full circle
    box-shadow: ${({ theme }) => theme.navigationBoxShadow};
    padding: ${({ theme }) => theme.spacing.regular} ${({ theme }) => theme.spacing.double};
    & + li {
        margin-left: ${({ theme }) => theme.spacing.double};
    }
    > * {
        vertical-align: middle;
    }
    svg {
        height: ${({ theme }) => theme.navigationIconSize};
        width: ${({ theme }) => theme.navigationIconSize};
        margin-right: ${({ theme }) => theme.spacing.regular};
    }
    transition: transform ${({ theme }) => theme.transitionsCurve};
    ${({ active, theme }) => !active && `
        color: ${theme.navigationColor};
        cursor: pointer;
        &:hover {
            transform: ${theme.navigationHoverTransform};
        }
    `};
    ${({ numNotification, theme }) => numNotification && `
        position: relative;
        animation: colorFlash ${theme.navigationFlashSpeed} infinite;
        &::after {
            content: "${numNotification}";
            background: red;
            color: white;
            font-size: 10px;
            border-radius: 20px;
            position: absolute;
            bottom: 0;
            left: ${theme.spacing.regular};
            padding: ${theme.spacing.small} ${theme.spacing.regular};
            @media (max-width: ${theme.mobileBreakpoint}) {
                left: 0;
            }            
        }
    `};
    @media (max-width: ${({ theme }) => theme.mobileBreakpoint}) {
        padding: ${({ theme }) => theme.spacing.regular} ${({ theme }) => theme.spacing.regular};
        & + li {
            margin-left: ${({ theme }) => theme.spacing.regular};
        }
        span {
            display: none;
        }
        svg {
            margin: 0;
            height: ${({ theme }) => theme.navigationIconSizeMobile};
            width: ${({ theme }) => theme.navigationIconSizeMobile};            
        }
    }

`;

const Navigation = ({
    activePage,
    numNewMessages,
    onPageChange
}: ReduxProps): JSX.Element => {
    const t = useTranslator();
    return <StyledNav>
        <ul>
            {PAGES.map(page =>
                <StyledNavItem
                    active={activePage === page}
                    key={page}
                    numNotification={page === PAGE_CHAT && numNewMessages}
                    onClick={() => activePage !== page && onPageChange(page)}>
                    {icons[page]}
                    <span>{t(`navigationTitle_${page}` as LocalizationKey)}</span>
                </StyledNavItem>
            )}
        </ul>
    </StyledNav>;
};

const icons = {
    [PAGE_CHAT]: <svg viewBox="0 0 512.012 512.012" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="m495.266 394.775c11.112-23.435 16.742-48.57 16.742-74.794 0-93.61-74.304-170.285-167.347-174.787-20.968-75.53-89.845-128.213-168.653-128.213-97.047 0-176 78.505-176 175 0 26.224 5.63 51.359 16.742 74.794l-16.451 82.265c-2.094 10.472 7.144 19.728 17.618 17.656l83.279-16.465c20.862 9.896 43.054 15.426 66.17 16.529 29.148 104.951 146.217 157.593 243.452 111.471 91.207 18.032 84.094 16.75 86.189 16.75 9.479 0 16.56-8.686 14.709-17.941zm-385.17-73.6c-3.001-1.534-6.433-2.013-9.737-1.359l-66.24 13.097 13.049-65.25c.663-3.315.187-6.759-1.354-9.77-10.487-20.516-15.806-42.691-15.806-65.912 0-79.953 65.495-145 146-145 62.915 0 118.319 40.91 137.681 99.417-91.706 11.725-160.775 94.472-151.914 189.891-18.075-1.737-35.391-6.787-51.679-15.114zm354.753 74.488 13.049 65.25-66.24-13.097c-3.306-.653-6.736-.175-9.737 1.359-20.516 10.487-42.691 15.806-65.912 15.806-79.953 0-145-65.047-145-145s65.047-145 145-145c80.505 0 146 65.047 146 145 0 23.221-5.318 45.396-15.806 65.912-1.541 3.011-2.017 6.454-1.354 9.77z"/></svg>,
    [PAGE_SETTINGS]: <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="m256 512c-30.879 0-56-25.122-56-56v-16.298c-11.863-3.606-23.331-8.359-34.292-14.212l-11.534 11.534c-10.574 10.573-24.635 16.396-39.594 16.396-14.966 0-29.031-5.823-39.604-16.396-21.829-21.843-21.827-57.37.001-79.197l11.534-11.534c-5.853-10.961-10.605-22.43-14.212-34.292h-16.299c-14.953 0-29.014-5.827-39.594-16.407s-16.406-24.642-16.406-39.594c0-30.878 25.121-56 56-56h16.299c3.606-11.863 8.359-23.331 14.212-34.292l-11.534-11.534c-10.574-10.574-16.397-24.635-16.397-39.594 0-14.965 5.823-29.03 16.396-39.604 21.844-21.831 57.37-21.828 79.198 0l11.534 11.534c10.961-5.853 22.429-10.605 34.292-14.212v-16.298c0-14.952 5.826-29.013 16.405-39.593 10.581-10.58 24.642-16.407 39.595-16.407 3.721 0 7.472.375 11.149 1.113 26.004 5.283 44.851 28.364 44.851 54.887v16.298c11.863 3.606 23.331 8.359 34.292 14.212l11.534-11.534c10.574-10.573 24.635-16.396 39.594-16.396 14.966 0 29.031 5.823 39.604 16.396 21.829 21.843 21.827 57.37-.001 79.197l-11.534 11.534c5.853 10.961 10.605 22.43 14.212 34.292h16.299c14.953 0 29.014 5.827 39.594 16.407s16.406 24.642 16.406 39.594c0 30.878-25.121 56-56 56h-16.299c-3.606 11.863-8.359 23.331-14.212 34.292l11.534 11.534c10.573 10.574 16.396 24.635 16.396 39.594 0 14.965-5.823 29.03-16.396 39.604-10.921 10.914-25.266 16.371-39.604 16.372-14.343.001-28.679-5.456-39.594-16.371l-11.534-11.534c-10.961 5.853-22.429 10.605-34.292 14.212v16.297c0 14.952-5.826 29.013-16.405 39.593-7.813 7.813-17.637 13.099-28.41 15.287-.012.002-.023.005-.035.007-3.677.738-7.428 1.113-11.149 1.113zm8-16.8h.01zm-100.925-105.7c2.913 0 5.843.793 8.453 2.419 14.892 9.274 31.071 15.978 48.088 19.926 7.251 1.682 12.384 8.143 12.384 15.586v28.569c0 13.233 10.767 24 24 24 1.601 0 3.222-.162 4.821-.481 4.592-.934 8.792-3.2 12.146-6.553 4.535-4.536 7.033-10.561 7.033-16.966v-28.57c0-7.443 5.133-13.904 12.384-15.586 17.017-3.948 33.196-10.652 48.088-19.926 6.314-3.933 14.511-2.994 19.771 2.268l20.21 20.21c9.355 9.354 24.583 9.354 33.946-.004 4.526-4.526 7.021-10.555 7.021-16.973 0-6.411-2.494-12.437-7.024-16.966l-20.209-20.209c-5.262-5.262-6.201-13.456-2.269-19.771 9.274-14.893 15.979-31.072 19.926-48.088 1.682-7.251 8.143-12.384 15.586-12.384h28.57c13.233 0 24-10.767 24-24 0-6.405-2.498-12.43-7.034-16.966-4.535-4.537-10.561-7.035-16.966-7.035h-28.57c-7.443 0-13.904-5.133-15.586-12.384-3.947-17.016-10.651-33.195-19.926-48.088-3.933-6.316-2.993-14.51 2.269-19.771l20.21-20.209c9.355-9.355 9.354-24.583-.004-33.946-4.525-4.526-10.555-7.02-16.973-7.02-6.411 0-12.438 2.495-16.967 7.024l-20.21 20.209c-5.262 5.263-13.456 6.201-19.771 2.268-14.892-9.274-31.071-15.978-48.088-19.926-7.251-1.683-12.384-8.144-12.384-15.587v-28.57c0-11.37-8.068-21.262-19.186-23.521-1.572-.315-3.204-.479-4.814-.479-6.405 0-12.431 2.498-16.967 7.034-4.535 4.536-7.033 10.561-7.033 16.966v28.57c0 7.443-5.133 13.904-12.384 15.586-17.017 3.948-33.196 10.652-48.088 19.926-6.313 3.934-14.51 2.994-19.771-2.268l-20.21-20.21c-9.355-9.355-24.583-9.353-33.946.004-4.526 4.526-7.021 10.555-7.021 16.973 0 6.411 2.494 12.437 7.024 16.966l20.209 20.209c5.262 5.262 6.201 13.456 2.269 19.771-9.274 14.893-15.979 31.072-19.926 48.088-1.681 7.252-8.142 12.385-15.586 12.385h-28.57c-13.233 0-24 10.767-24 24 0 6.405 2.498 12.43 7.034 16.966 4.535 4.536 10.561 7.034 16.966 7.034h28.57c7.443 0 13.904 5.133 15.586 12.384 3.947 17.016 10.651 33.195 19.926 48.088 3.933 6.316 2.993 14.51-2.269 19.771l-20.21 20.209c-9.355 9.355-9.354 24.583.004 33.946 4.525 4.526 10.555 7.02 16.973 7.02 6.411 0 12.438-2.495 16.967-7.024l20.21-20.209c3.087-3.086 7.184-4.685 11.318-4.685z"/><path fill="currentColor" d="m256 368c-61.757 0-112-50.243-112-112s50.243-112 112-112c3.181 0 6.339.135 9.389.4 27.848 2.289 53.742 14.915 72.835 35.548 19.201 20.75 29.776 47.76 29.776 76.052s-10.575 55.302-29.776 76.052c-19.093 20.633-44.987 33.259-72.913 35.555-2.972.258-6.13.393-9.311.393zm0-192c-44.112 0-80 35.888-80 80s35.888 80 80 80c2.258 0 4.482-.094 6.611-.279 41.187-3.386 73.389-38.4 73.389-79.721s-32.202-76.335-73.311-79.714c-2.207-.192-4.431-.286-6.689-.286z"/></svg> 
};

export default Navigation;